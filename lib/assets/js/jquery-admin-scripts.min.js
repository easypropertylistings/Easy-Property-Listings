function epl_generate_inspection_markup(){(new Date).getFullYear();var e='<div class="epl-inspection-msg"></div><div class="epl-added-inspection"></div><a class="epl-update-inspection-times" href="#">'+epl_admin_vars.inspection_times+'</a><div id="epl-inspection-markup" class="epl-inspection-markup"> <div class="epl-inspection-markup-inner">';return(e+='<div class="epl-inspection-col"> <div class="epl-inspection-field-label"> Date </div> <div class="epl-inspection-col-items"> <input type="text" autocomplete="off" id="epl-inspection-date" maxlength="2" size="2" placeholder="01"></div></div>')+'<div class="epl-inspection-col"> <div class="epl-inspection-field-label"> Start </div>'+'<div class="epl-inspection-col-items"><div class="epl-inspection-col-item">'+'<input class="" type="text" autocomplete="off" id="epl-inspection-start-time" placeholder="01:05">'+'<select id="epl-inspection-start-ampm" class="epl-inspection-ampm">'+'<option value="AM">AM</option>'+'<option value="PM">PM</option>'+"</select>"+' <div class="epl-inspection-field-label"> End </div> </div><div class="epl-inspection-col-item">'+'<input class="" type="text" autocomplete="off" id="epl-inspection-end-time" placeholder="01:05">'+'<select id="epl-inspection-end-ampm" class="epl-inspection-ampm">'+'<option value="AM">AM</option>'+'<option value="PM">PM</option>'+'</select></div><div class="epl-inspection-col-item epl-inspection-controls"><a id="epl-inspection-add" class="button">Add</a></div></div></div>'+"</div></div>"}jQuery(document).ready(function(o){var e,t,a={init:function(){this.display_address_note(),this.admin_listings_map(),a.manual_update(),this.mark_featured(),this.init_conditionals(),this.handle_conditional_fields(),this.init_settings_conditionals(),this.handle_settings_conditional_fields()},display_address_note:function(){jQuery(document).find("#property_address_display_yes").on("change",function(){var e;jQuery(".epl-display-address-warning").remove(),jQuery(this).is(":checked")?jQuery(".epl-display-address-warning").remove():(e='<div class="notice notice-warning epl-display-address-warning" style="margin:10px 0;"><p>'+epl_admin_vars.display_address_note+"</p></div>",jQuery("#epl_property_address_coordinates").after(e))}),setTimeout(function(){jQuery(document).find("#property_address_display_yes").trigger("change")},1e3)},admin_listings_map:function(){if(0===o("#epl_admin_map_canvas").length)return!1;var e=o("#epl_admin_map_canvas").data("address"),t="";if(!window.google)return!1;function a(e){var t=new google.maps.Map(document.getElementById("epl_admin_map_canvas"),{zoom:14,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP}),e=new google.maps.Marker({position:e,draggable:!0});google.maps.event.addListener(e,"dragend",function(e){o("#property_address_coordinates").val(e.latLng.lat()+", "+e.latLng.lng())}),google.maps.event.addListener(e,"dragstart",function(e){}),t.setCenter(e.position),e.setMap(t)}function l(e){(new google.maps.Geocoder).geocode({address:e},function(e){a(t=e[0].geometry.location),o("#property_address_coordinates").val(t.lat().toString()+", "+t.lng().toString())})}""===e&&(e=epl_admin_vars.default_map_address);var n,i=o("#property_address_coordinates").val();!i||(i=i.split(", "),n=parseFloat(i[0]),i=parseFloat(i[1]),isNaN(n))||isNaN(i)?l(e):a(new google.maps.LatLng(n,i)),o(document.body).on("click",".epl-geocoder-button",function(){var a=o(this),n=(listingUnit=a.closest("form").find("#property_address_sub_number").length?a.closest("form").find("#property_address_sub_number").val():a.closest("form").find("#property_address_lot_number").length?a.closest("form").find("#property_address_lot_number").val():"")+" ";o(["property_address_street_number","property_address_street","property_address_suburb","property_address_state","property_address_postal_code","property_address_country"]).each(function(e,t){0<a.closest("form").find("#"+t).length&&(n+=a.closest("form").find("#"+t).val()+" ")}),n=o.trim(n),o("#property_address_coordinates").val(""),n&&l(n)}),o("#property_address_coordinates").on("change",function(){var e,t=o(this).val();t&&(t=t.split(", "),e=parseFloat(t[0]),t=parseFloat(t[1]),isNaN(e)||isNaN(t)||a(new google.maps.LatLng(e,t)))})},manual_update:function(){jQuery("#epl_manual_update_lookup").on("click",function(e){e.preventDefault();var e=window.location.href.split("?")[0],t=window.location.href.split("?")[1];e=null==t?e+"?epl_manual_update=1":e+"?"+t+"&epl_manual_update=1",window.location.replace(e)})},mark_featured:function(){o(".column-property_featured span").on("click",function(e){var t=o(this),a=o(this).closest("tr").attr("id");a=(a=a.split("-"))[1],o.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"epl_update_featured_listing",id:a,_epl_nonce:epl_admin_vars.ajax_nonce},success:function(e){t.toggleClass("dashicons-star-empty dashicons-star-filled"),"no"==e.featured?t.closest("tr").find(".epl-listing-labels .featured").remove():t.closest("tr").find(".epl-listing-labels").append('<li class="featured">Featured</li>')}})})},init_conditionals:function(){o(".epl-form-field-wrap input, .epl-form-field-wrap select, .epl-form-field-wrap textarea, .epl-form-field-wrap .epl-form-field-help").each(function(e){var t,a=o(this).closest(".epl-form-field-wrap"),l=!0,n=o(this).data("show");n&&(t=n.relation||"AND",n=n.fields||{},"AND"==t||"and"==t?o.each(n,function(e,t){var a=t[0],n=t[1],t=t[2];o("#"+a).length&&("="===n?l&=t==o("#"+a).val():"!="===n?l&=t!=o("#"+a).val():">="===n?l&=parseFloat(o("#"+a).val())>=t:"<="===n?l&=parseFloat(o("#"+a).val())<=t:">"===n?l&=parseFloat(o("#"+a).val())>t:"<"===n&&(l&=parseFloat(o("#"+a).val())<t))}):(l=!1,o.each(n,function(e,t){var a=t[0],n=t[1],t=t[2];o("#"+a).length&&("="===n?l=l||t==o("#"+a).val():"!="===n?l=l||t!=o("#"+a).val():">="===n?l=l||parseFloat(o("#"+a).val())>=t:"<="===n?l=l||parseFloat(o("#"+a).val())<=t:">"===n?l=l||parseFloat(o("#"+a).val())>t:"<"===n&&(l=l||parseFloat(o("#"+a).val())<t))})),l?a.show():a.hide())})},init_settings_conditionals:function(){o(".epl-field input, .epl-field select, .epl-field textarea, .epl-field .epl-form-field-help").each(function(e){var t,a=o(this).closest(".epl-field"),l=!0,n=o(this).data("show");n&&(t=n.relation||"AND",n=n.fields||{},"AND"==t||"and"==t?o.each(n,function(e,t){var a=t[0],n=t[1],t=t[2];o("#"+a).length&&("="===n?l&=t==o("#"+a).val():"!="===n?l&=t!=o("#"+a).val():">="===n?l&=parseFloat(o("#"+a).val())>=t:"<="===n?l&=parseFloat(o("#"+a).val())<=t:">"===n?l&=parseFloat(o("#"+a).val())>t:"<"===n&&(l&=parseFloat(o("#"+a).val())<t))}):(l=!1,o.each(n,function(e,t){var a=t[0],n=t[1],t=t[2];o("#"+a).length&&("="===n?l=l||t==o("#"+a).val():"!="===n?l=l||t!=o("#"+a).val():">="===n?l=l||parseFloat(o("#"+a).val())>=t:"<="===n?l=l||parseFloat(o("#"+a).val())<=t:">"===n?l=l||parseFloat(o("#"+a).val())>t:"<"===n&&(l=l||parseFloat(o("#"+a).val())<t))})),l?a.show():a.hide())})},handle_conditional_fields:function(){o(".epl-form-field-wrap input, .epl-form-field-wrap select, .epl-form-field-wrap textarea").on("change",function(e){a.init_conditionals()})},handle_settings_conditional_fields:function(){var e=o(".epl-field input, .epl-field select, .epl-field textarea");e.on("change",function(e){a.init_settings_conditionals()}),e.each(function(){o(this).trigger("change")})}};function n(e,t,a){a=a||window.location.href;var n,l=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi");return l.test(a)?null!=t?a.replace(l,"$1"+e+"="+t+"$2$3"):(a=(n=a.split("#"))[0].replace(l,"$1$3").replace(/(&|\?)$/,""),void 0!==n[1]&&null!==n[1]&&(a+="#"+n[1]),a):(null!=t&&(l=-1!==a.indexOf("?")?"&":"?",a=(n=a.split("#"))[0]+l+e+"="+t,void 0!==n[1])&&null!==n[1]&&(a+="#"+n[1]),a)}function l(){var a=[];for(let t=0;t<=11;t++)for(let e=0;e<60;e+=5){var n=t.toString().padStart(2,"0"),l=e.toString().padStart(2,"0");a.push(n+":"+l)}return a}a.init(),0<o('input[name="epl_upload_button"]').length&&"undefined"!=typeof wp&&wp.media&&wp.media.editor&&o(document).on("click",'input[name="epl_upload_button"]',function(e){e.preventDefault();var e=o(this),a=e.prev();return wp.media.editor.send.attachment=function(e,t){console.log(t),a.val(t.url)},wp.media.editor.open(e),!1}),o(".dependency-true").each(function(){var e,t=o(this),a=t.attr("data-parent");o('select[name="'+a+'"]').length&&"taxonomy"==t.attr("data-type")&&(e=t.attr("data-default"),o('select[name="'+a+'"]').change(function(){o.ajax({type:"POST",url:ajaxurl,data:{parent_id:o(this).val(),type_name:t.attr("data-type-name"),type:t.attr("data-type"),default_value:e,action:"epl_get_terms_drop_list",_epl_nonce:epl_admin_vars.ajax_nonce},success:function(e){t.html(e)}})}).trigger("change"))}),o(".epldatepicker").length&&o(".epldatepicker").each(function(e){var t=o(this).data("timepicker"),a=o(this).data("format");console.log(a),t=1==t,o(this).epl_datetimepicker({timepicker:t,format:a})}),o("#property_auction").length&&o("#property_auction").epl_datetimepicker({format:"Y-m-d H:i",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),o("#property_sold_date").length&&o("#property_sold_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),o("#property_list_date").length&&o("#property_list_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),o("#property_com_lease_end_date").length&&o("#property_com_lease_end_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),o("#property_date_available").length&&o("#property_date_available").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),o("#property_inspection_times").length&&(o("#property_inspection_times").hide(),e=(e=o("#property_inspection_times").val()).split("\n"),t='<tr class="form-field"><td>'+epl_generate_inspection_markup()+"</td></tr>",o("#property_inspection_times").closest(".form-field").after(t),""!=o.trim(e)&&o.each(e,function(e,t){o(".epl-added-inspection").append('<span><span class="epl-inspection-text">'+t+'</span><span class="del-inspection-time">X</span></span>')}),jQuery("#epl-inspection-date").epl_datetimepicker({timepicker:!1,format:"d-M-Y",closeOnDateSelect:!0,allowBlank:!1,inline:!0,defaultDate:new Date}),jQuery("#epl-inspection-start-time").epl_datetimepicker({datepicker:!1,format:"h:i",hours12:!0,allowTimes:l()}),jQuery("#epl-inspection-end-time").epl_datetimepicker({datepicker:!1,format:"h:i",hours12:!0,allowTimes:l()})),jQuery("form").length&&"function"==typeof jQuery.fn.validationEngine&&jQuery("form").validationEngine(),o(document).on("click",".del-inspection-time",function(){var t=o(this).parent().find(".epl-inspection-text").text(),e=(e=o("#property_inspection_times").val()).split("\n");e=(e=jQuery.grep(e,function(e){return e!=t})).join("\n"),o("#property_inspection_times").val(e),o(this).parent().fadeOut(600,function(){o(this).remove()})}),o(document).on("click","#epl-inspection-add",function(e){e.preventDefault(),o(".epl-inspection-msg").html("");var e=o("#epl-inspection-date").val(),t=o("#epl-inspection-start-time").val(),a=o("#epl-inspection-start-ampm").val(),n=o("#epl-inspection-end-time").val(),l=o("#epl-inspection-end-ampm").val();e&&t&&a&&n&&l?(e=e+" "+t+a+" to "+n+l,t=(t=o("#property_inspection_times").val()).split("\n"),-1==o.inArray(e,t)?(t.push(e),a=o('<span><span class="epl-inspection-text">'+e+'</span><span class="del-inspection-time">&times;</span></span>'),t=t.join("\n"),o("#property_inspection_times").val(t),a.hide().appendTo(".epl-added-inspection").fadeIn(600)):o(".epl-inspection-msg").html("Duplicate inspection entry.")):o(".epl-inspection-msg").html("All fields are required. Please fill out all inspection details.")}),o(".epl-price-bar").hover(function(){o(this).addClass("shine")},function(){o(this).removeClass("shine")}),jQuery(".epl-fields-tab-menu ul li").click(function(){var e=jQuery(this).attr("data-tab"),t=n("sub_tab",e);history.pushState("","",t),jQuery(".epl-fields-tab-menu ul li").removeClass("epl-fields-menu-current"),jQuery(".epl-fields-single-menu").removeClass("epl-fields-field-current"),jQuery(".epl-field-intro").removeClass("active epl-show-help"),jQuery('[data-help="'+e+'"]').addClass("active epl-show-help"),jQuery(this).addClass("epl-fields-menu-current"),console.log("#tab-menu-"+e),jQuery("#"+e).addClass("epl-fields-field-current")}),o(".epl-upgrade-btn").length&&o(".epl-upgrade-btn").on("click",function(e){e.preventDefault(),function t(){var e=o(".epl-upgrade-btn").data("upgrade"),e=(o(".epl-upgrade-btn"),{action:"epl_upgrade_db",upgrade_to:e,_epl_nonce:epl_admin_vars.ajax_nonce});o(".epl-ajax-notice").show(),o.ajax({method:"POST",url:ajaxurl,data:e,dataType:"json"}).done(function(e){if("success"==e.status){if(o(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-success").html(e.msg),"processing"==e.buffer)try{t()}catch(e){o(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-fail").html("Please reload page & process again.")}}else o(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-fail").html(e.msg)})}()});var i,s,c,r={vars:{contact_card_wrap_editable:o(".epl-contact-card-wrapper .editable"),contact_card_wrap_edit_item:o(".epl-contact-card-wrapper .edit-item"),user_id:o('input[name="contactinfo[user_id]"]'),state_input:o(':input[name="contactinfo[state]"]'),note:o("#epl_contact_activity_content")},init:function(){this.edit_contact(),this.user_search(),this.remove_user(),this.cancel_edit(),this.change_country(),this.add_note(),this.add_note_note_tab(),this.add_listing(),this.delete_checked()},edit_contact:function(){o(document.body).on("click","#edit-contact",function(e){e.preventDefault(),r.vars.contact_card_wrap_editable.hide(),r.vars.contact_card_wrap_edit_item.fadeIn().css("display","block")})},user_search:function(){o(document.body).on("click.eplSelectUser",".epl_user_search_results a",function(e){e.preventDefault();e=o(this).data("userid");r.vars.user_id.val(e)})},remove_user:function(){o(document.body).on("click","#disconnect-contact",function(e){e.preventDefault();e={epl_action:"disconnect-userid",contact_id:o('input[name="contactinfo[id]"]').val(),_wpnonce:o("#edit-contact-info #_wpnonce").val()};o.post(ajaxurl,e,function(e){window.location.href=window.location.href},"json")})},cancel_edit:function(){o(document.body).on("click","#epl-edit-contact-cancel",function(e){e.preventDefault(),r.vars.contact_card_wrap_edit_item.hide(),r.vars.contact_card_wrap_editable.show(),o(".epl_user_search_results").html("")})},change_country:function(){o('select[name="contactinfo[country]"]').change(function(){var e=o(this);return data={action:"epl_get_shop_states",country:e.val(),field_name:"contactinfo[state]",_epl_nonce:epl_admin_vars.ajax_nonce},o.post(ajaxurl,data,function(e){"nostates"==e?r.vars.state_input.replaceWith('<input type="text" name="'+data.field_name+'" value="" class="epl-edit-toggles medium-text"/>'):r.vars.state_input.replaceWith(e)}),!1})},add_note_note_tab:function(){o(document.body).on("click","#add-contact-note",function(e){e.preventDefault();var t,e={epl_action:"add-contact-note-note-tab",contact_id:o("#epl-contact-id").val(),listing_id:o("#contact-note-listing").val(),activity_type:o("#contact-activity-type").val(),contact_note:o("#contact-note").val(),add_contact_note_nonce:o("#add_contact_note_nonce").val()};console.log(e),e.contact_note?o.ajax({type:"POST",data:e,url:ajaxurl,success:function(e){o("#epl-contact-notes").prepend(e),o(".epl-no-contact-notes").hide(),o("#contact-note").val("")}}).fail(function(e){window.console&&window.console.log&&console.log(e)}):(t=r.vars.note.css("border-color"),r.vars.note.css("border-color","red"),setTimeout(function(){r.vars.note.css("border-color",t)},500))})},add_note:function(){o(document.body).on("click","#epl_contact_activity_submit",function(e){e.preventDefault();var t,e={epl_action:"add-contact-note",contact_id:o("#epl_contact_id").val(),listing_id:o("#epl_contact_activity_listing").val(),note_type:o("#epl_contact_activity_type").val(),contact_note:r.vars.note.val(),add_contact_note_nonce:o("#add_contact_note_nonce").val()};e.contact_note?o.ajax({type:"POST",data:e,url:ajaxurl,success:function(e){r.vars.note.val(""),o(".epl-contact-activities tbody").prepend(e)}}).fail(function(e){window.console&&window.console.log&&console.log(e)}):(t=r.vars.note.css("border-color"),r.vars.note.css("border-color","red"),setTimeout(function(){r.vars.note.css("border-color",t)},500))})},add_listing:function(){o(document.body).on("click","#contact_listing_submit",function(e){e.preventDefault();var t,e=data=o("#epl_contact_add_listing_form").serialize();(e+="&epl_action=add-contact-listing&contact_id="+o("#epl_contact_id").val()+"&_epl_nonce="+epl_admin_vars.ajax_nonce)?o.ajax({type:"POST",data:e,url:ajaxurl,success:function(e){r.vars.note.val(""),o(".epl-contact-listings tbody").prepend(e)}}).fail(function(e){window.console&&window.console.log&&console.log(e)}):(t=r.vars.note.css("border-color"),r.vars.note.css("border-color","red"),setTimeout(function(){r.vars.note.css("border-color",t)},500))})},delete_checked:function(){o("#epl-contact-delete-confirm").change(function(){var e=o("#epl-contact-delete-records"),t=o("#epl-delete-contact");o(this).prop("checked")?(e.attr("disabled",!1),t.attr("disabled",!1)):(e.attr("disabled",!0),e.prop("checked",!1),t.attr("disabled",!0))})}};r.init(),o(".contact-action-category").on("click",function(e){e.preventDefault(),e.stopPropagation(),jQuery(".epl-contact_category_suggestions").slideToggle(100)}),o(".contact-action-tag").on("click",function(e){e.preventDefault(),e.stopPropagation(),jQuery(".epl-contact-tags-find").slideToggle(100),o("#contact-tag-hint").focus()}),o(document).on("click",function(e){o(".epl-contact_category_suggestions").is(":visible")&&jQuery(".epl-contact_category_suggestions").slideUp(100),o(".epl-contact-tags-find").is(":visible")&&!o(".epl-contact-tags-find > input").is(":focus")&&jQuery(".epl-contact-tags-find").slideUp(100)}),o(".epl-contact_category_suggestions > li >  a").on("click",function(e){e.preventDefault();var t=o(this).data("label");o.ajax({type:"POST",data:{action:"epl_contact_category_update",type:o(this).data("key"),contact_id:o("#epl_contact_id").val(),_epl_nonce:epl_admin_vars.ajax_nonce},dataType:"json",url:ajaxurl,success:function(e){e&&o(".epl-contact-entry-header span").text(t)}})}),o(".epl-contact_tags_suggestions > li").on("click",function(e){e.preventDefault();var t={action:"contact_tags_update",contact_id:o("#epl_contact_id").val(),term_id:o(this).data("id"),bg:o(this).data("bg"),label:o(this).text(),_epl_nonce:epl_admin_vars.ajax_nonce};if(1<=o("#contact-tag-"+t.term_id).length)return!1;o.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){o("#contact-tag-hint").val(""),o(".epl-contact_tags_suggestions > li").hide(),e&&(o("#contact-tag-hint").val(""),e='<li style="background:'+t.bg+'" data-id="'+t.term_id+'" id="contact-tag-'+t.term_id+'">'+t.label+'<span class="dashicons dashicons-no epl-contact-tag-del"></span></li>',o(".epl-contact-assigned-tags").append(e))}})}),o(".epl-contact-assigned-tags").on("click",".epl-contact-tag-del",function(e){e.preventDefault();var t=o(this),e={action:"epl_contact_tag_remove",contact_id:o("#epl_contact_id").val(),term_id:o(this).parent().data("id"),label:o(this).parent().text(),_epl_nonce:epl_admin_vars.ajax_nonce};o.ajax({type:"POST",data:e,url:ajaxurl,success:function(e){e&&t.parent().fadeIn(200).remove()}})}),o("#contact-tag-hint").keyup(function(e){var t=o(this).val();if(""==t)return!1;if(o(".epl-contact_tags_suggestions>li").each(function(){0==o(this).text().toLowerCase().indexOf(t)?o(this).show():o(this).hide()}),13==e.keyCode){var a={action:"contact_tags_update",contact_id:o("#epl_contact_id").val(),term_id:t,bg:"#39b54a",_epl_nonce:epl_admin_vars.ajax_nonce,label:t.charAt(0).toUpperCase()+t.slice(1)};if(1<=o("#contact-tag-"+epl.helpers.string_to_name(a.term_id).length))return!1;o.ajax({type:"POST",data:a,url:ajaxurl,success:function(e){o("#contact-tag-hint").val(""),o(".epl-contact_tags_suggestions > li").hide(),e&&(o("#contact-tag-hint").val(""),e='<li style="background:'+a.bg+'" data-id="'+e+'" id="contact-tag-'+e+'">'+a.term_id+'<span class="dashicons dashicons-no epl-contact-tag-del"></span></li>',o(".epl-contact-assigned-tags").append(e),jQuery(".epl-contact-tags-find").slideUp(100))}})}}),o(".epl-contact-add-activity").on("click",function(){var e="Add New"==o(".epl-contact-add-activity").text()?"Close":"Add New";o(".epl-contact-add-activity").text(e),o("#epl-contact-add-activity-wrap").slideToggle(100)}),o(".epl-contact-add-listing").on("click",function(){o("#epl-contact-add-listing-wrap").slideToggle(100)}),o(".epl-contact-addable:last").after('<span class="epl-contact-add-new-num">add another</span>'),o(".epl-contact-addable-email:last").after('<span class="epl-contact-add-new-email">add another</span>'),o(document).on("click",".epl-contact-add-new-num",function(){var e='                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <div class="epl-contact-new-num">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <input type="number" maxlength="60" class="epl-contact-sub" name="'+epl.helpers.get_unique_name("phone","contact_phones")+'">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <select id="epl-contact-sub-select" type="select" class="epl-contact-note-select" >                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <option value="phone">Phone</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <option value="mobile">Mobile</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <option value="office">Office</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <option value="home">Home</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </select>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ';o(this).before(e)}),o(document).on("click",".epl-contact-add-new-email",function(){var e='                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <div class="epl-contact-new-email">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <input type="email" maxlength="60" class="epl-contact-sub" name="'+epl.helpers.get_unique_name("email","contact_emails")+'">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <select id="epl-contact-sub-mail" type="select" class="epl-contact-note-select" >                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <option value="email">Email</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <option value="work">Work</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <option value="office">Office</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <option value="home">Home</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </select>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ';o(this).before(e)}),1==jQuery(".epl-contact-view-more").length&&195<=jQuery(".epl-contact-main-wrapper.left")[0].scrollHeight&&jQuery(".epl-contact-view-more").css("display","block"),jQuery(".epl-contact-view-more").on("click",function(){var e=jQuery(this).closest(".epl-contact-main-wrapper.left").height();e<=190?(jQuery(this).closest(".epl-contact-main-wrapper.left").height("auto"),jQuery(this).css("position","relative").html('<span class="dashicons dashicons-arrow-right-alt epl-contact-icons"></span>View Less')):(jQuery(this).closest(".epl-contact-main-wrapper.left").height("190px"),jQuery(this).css("position","absolute").html('<span class="dashicons dashicons-arrow-right-alt epl-contact-icons"></span>View More')),console.log(e)}),o(document).on("click","#epl-contact-sub-select",function(){var e=epl.helpers.get_unique_name(o(this).val(),"contact_phones");o(this).prev().attr("name",e)}),o(document).on("click","#epl-contact-sub-mail",function(){var e=epl.helpers.get_unique_name(o(this).val(),"contact_emails");o(this).prev().attr("name",e)}),o("#epl-item-tables-wrapper").on("click","th",function(e){e.preventDefault();e=o(this),o("#epl-contact-table-orderby").val(o(this).data("sort")),console.log(o("#epl-contact-table-orderby").val()),e.hasClass("epl-sorted-desc")?(e.addClass("epl-sorted-asc"),o("#epl-contact-table-order").val("ASC")):(o("#epl-contact-table-order").val("DESC"),e.addClass("epl-sorted-desc")),e={action:"epl_contact_get_activity_table",contact:o("#epl_contact_id").val(),number:10,paged:1,orderby:o("#epl-contact-table-orderby").val(),order:o("#epl-contact-table-order").val(),_epl_nonce:epl_admin_vars.ajax_nonce};o.ajax({type:"POST",data:e,url:ajaxurl,success:function(e){e&&o("#epl-contact-activity-table-wrapper").html(e)}})}),o(document).on("click",".epl-contact-load-activities",function(e){var t=o(this).data("page"),t={action:"epl_contact_get_activity_table",contact:o("#epl_contact_id").val(),number:10,paged:t,orderby:o("#epl-contact-table-orderby").val(),order:o("#epl-contact-table-order").val(),_epl_nonce:epl_admin_vars.ajax_nonce};o.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){var t;0!=e&&(t=o(e).find("tbody").html(),e=o(e).find(".epl-contact-load-activities").data("page"),o("#epl-contact-activity-table-wrapper").find("tbody").append(t),o(".epl-contact-load-activities").data("page",e))}})}),{init:function(){this.date_options()},date_options:function(){o("#epl-graphs-date-options").change(function(){var e=o(this),t=o("#epl-date-range-options");"other"===e.val()?t.show():t.hide()})}}.init(),1==o("#property_owner").length&&(i=null,o("#property_owner").keyup(function(){if(""==o("#property_owner").val())return o(".epl-contact-listing-suggestion").fadeOut(),!1;null!=i&&clearTimeout(i);var e=o(this).val();data={action:"epl_search_contact",user_name:e,_epl_nonce:epl_admin_vars.ajax_nonce},i=setTimeout(function(){i=null,o.ajax({type:"POST",data:data,url:ajaxurl,success:function(e){1==o(".epl-contact-listing-suggestion").length?o(".epl-contact-listing-suggestion").replaceWith(e):o("#property_owner").after(e),o(".epl-contact-listing-suggestion").fadeIn()}})},300)}),o(document.body).on("click",".epl-contact-listing-suggestion li",function(e){o("#property_owner").val(o(this).data("id")),o(".epl-contact-listing-suggestion").fadeOut()})),1==o("#epl_contact_wp_user").length&&(s=null,o("#epl_contact_wp_user").keyup(function(e){var t=e.currentTarget;if(document.body.style.cursor="progress",""==o(t).val())return o(".epl-contact-user-suggestion").fadeOut(),!1;null!=s&&clearTimeout(s);e=o(this).val();data={action:"epl_search_user",user_name:e,_epl_nonce:epl_admin_vars.ajax_nonce},s=setTimeout(function(){s=null,o.ajax({type:"POST",data:data,url:ajaxurl,success:function(e){document.body.style.cursor="auto",1==o(".epl-contact-user-suggestion").length?o(".epl-contact-user-suggestion").replaceWith(e):o(t).after(e),o(".epl-contact-user-suggestion").fadeIn()}})},300)}),o(document.body).on("click",".epl-contact-user-suggestion li",function(e){o("#epl_contact_wp_user").val(o(this).text()),o("#epl_contact_wp_user_id").val(o(this).data("id")),o(".epl-contact-user-suggestion").fadeOut()})),0<o(".epl-widget-author-username").length&&(s=null,o(".epl-widget-author-username").keyup(function(e){var t=e.currentTarget;if(document.body.style.cursor="progress",""==o(t).val())return o(".epl-contact-user-suggestion").fadeOut(),!1;null!=s&&clearTimeout(s);e=o(this).val();e=(e=e.split(","))[e.length-1],data={action:"epl_search_user",user_name:e,exclude_roles:"subscriber",_epl_nonce:epl_admin_vars.ajax_nonce},s=setTimeout(function(){s=null,o.ajax({type:"POST",data:data,url:ajaxurl,success:function(e){document.body.style.cursor="auto",1==o(".epl-contact-user-suggestion").length?o(".epl-contact-user-suggestion").replaceWith(e):o(t).after(e),o(".epl-contact-user-suggestion").fadeIn()}})},300)}),o(document.body).on("click",".epl-contact-user-suggestion li",function(e){var t=o(this).closest(".epl-contact-user-suggestion").prev(),a=t.val();(curr_val_arr=a.split(",")).splice(-1,1),a=""==(a=curr_val_arr.join(","))?o(this).data("uname")+",":a+","+o(this).data("uname")+",",t.val(a),o(".epl-contact-user-suggestion").fadeOut().remove()})),1!=o("#property_second_agent").length&&1!=o("#property_agent").length||(s=null,o("#property_fourth_agent,#property_third_agent,#property_second_agent,#property_agent").keyup(function(e){var t=e.currentTarget;if(document.body.style.cursor="progress",""==o(t).val())return o(".epl-contact-user-suggestion").fadeOut(),!1;null!=s&&clearTimeout(s);e=o(this).val();data={action:"epl_search_user",user_name:e,_epl_nonce:epl_admin_vars.ajax_nonce},s=setTimeout(function(){s=null,o.ajax({type:"POST",data:data,url:ajaxurl,success:function(e){document.body.style.cursor="auto",1==o(".epl-contact-user-suggestion").length?o(".epl-contact-user-suggestion").replaceWith(e):o(t).after(e),o(".epl-contact-user-suggestion").fadeIn()}})},300)}),o(document.body).on("click",".epl-contact-user-suggestion li",function(e){o(this).closest(".epl-contact-user-suggestion").prev().val(o(this).data("uname")),o(".epl-contact-user-suggestion").fadeOut().remove()})),1==o("#epl_contact_listing_search").length&&(c=null,o("#epl_contact_listing_search").keyup(function(){if(""==o("#epl_contact_listing_search").val())return o(".epl-contact-owned-listing-suggestion").fadeOut(),!1;null!=c&&clearTimeout(c);var e=o(this).val();data={action:"epl_search_contact_listing",s:e,contact:o("#epl_contact_id").val(),_epl_nonce:epl_admin_vars.ajax_nonce},c=setTimeout(function(){c=null,o.ajax({type:"POST",data:data,url:ajaxurl,success:function(e){1==o(".epl-contact-owned-listing-suggestion").length?o(".epl-contact-owned-listing-suggestion").replaceWith(e):o("#epl_contact_listing_search").after(e),o(".epl-contact-owned-listing-suggestion").fadeIn()}})},300)}),o(document.body).on("click",".epl-contact-owned-listing-suggestion li",function(e){var t=o(this).data("id");o.ajax({type:"POST",data:{epl_action:"add-existing-contact-listing",contact_id:o("#epl_contact_id").val(),id:t,_epl_nonce:epl_admin_vars.ajax_nonce},url:ajaxurl,success:function(e){o(".epl-contact-listings tbody").prepend(e),o(".epl-contact-owned-listing-suggestion").fadeOut(),o("#epl_contact_listing_search").val("")}})})),o(document.body).on("click.eplSelectUser",".epl_user_search_results span a",function(e){e.preventDefault();e=o(this).data("login");o(".epl-ajax-user-search").val(e),o(".epl_user_search_results").addClass("hidden"),o(".epl_user_search_results span").html("")}),o(document.body).on("click.eplCancelUserSearch",".epl_user_search_results a.epl-ajax-user-cancel",function(e){e.preventDefault(),o(".epl-ajax-user-search").val(""),o(".epl_user_search_results").addClass("hidden"),o(".epl_user_search_results span").html("")}),o("#epl-contact-add-listing-wrap").on("blur","input",function(e){var t="",t=(t=(t=(t=(t=(t=(t=(t+=""!=o("#property_address_lot_number").val()?o("#property_address_lot_number").val()+"/":"")+(""!=o("#property_address_sub_number").val()?o("#property_address_sub_number").val()+" ":""))+(""!=o("#property_address_street_number").val()?o("#property_address_street_number").val()+" ":""))+(""!=o("#property_address_street").val()?o("#property_address_street").val()+" ":""))+(""!=o("#property_address_suburb").val()?o("#property_address_suburb").val()+" ":""))+(""!=o("#property_address_state").val()?o("#property_address_state").val()+" ":""))+(""!=o("#property_address_postal_code").val()?o("#property_address_postal_code").val()+" ":""))+(""!=o("#property_address_country").val()?o("#property_address_country").val()+" ":"");o("#post_title").val(t)}),o(document).on("change",".epl_contact_type_filter",function(e){var t=o(this).val();""!=t&&(document.location.href=n("cat_filter",t))}),o(".epl-contact-list-table-tags").on("click",".epl-contact-assigned-tags li",function(e){var t=o(this).data("id");""!=t&&(document.location.href=n("tag_filter",t))}),o(".epl-contact-all-tags-container > span .epl-tag-btn").on("mouseleave",function(e){if(o(this).parent().hasClass("epl-lock"))return!1;o(this).css({background:"#fff",color:o(this).data("accent")})}),o(".epl-contact-all-tags-container > span .epl-tag-btn").on("mouseenter",function(e){if(o(this).parent().hasClass("epl-lock"))return!1;o(this).css({background:o(this).data("accent"),color:"#fff"})}),o(document.body).on("click",".epl-contact-all-tags-container > span .epl-tag-btn",function(e){if(par=o(this).parent(),e.preventDefault(),o(this).parent().hasClass("epl-lock"))return!1;par.siblings().removeClass("epl-lock").find(".epl-popup-box").remove(),par.siblings().find(".epl-tag-btn").trigger("mouseleave"),par.toggleClass("epl-lock");1!=o(this).find(".epl-popup-box").length&&o('<div class="epl-popup-box epl-all-tags-single-tag">\n    <span class="epl-single-tag-name">\n        <input type="text" id="epl-single-tag-name-input">\n    </span>\n    <ul class="epl-colors-list" >\n        <li class="epl-color-gray" data-color="#d2d2d2"><b></b></li>\n        <li class="epl-color-green" data-color="#43ac6d"><b></b></li>\n        <li class="epl-color-blue" data-color="#459bc4"><b></b></li>\n        <li class="epl-color-orange" data-color="#f9845b"><b></b></li>\n        <li class="epl-color-purple" data-color="#7d669e"><b></b></li>\n        <li class="epl-color-red" data-color="#ed5a5a"><b></b></li>\n        <li class="epl-color-yellow" data-color="#ecc33f"><b></b></li>\n    </ul>\n    <div class="epl-single-tag-opts">\n        <span data-action="filter" title="Filter" class="dashicons dashicons-filter"></span>\n        <span data-action="delete" title="Trash" class="dashicons dashicons-trash"></span>\n    </div>\n</div>').appendTo(par).slideDown()}),{init:function(){this.update_bg(),this.update_name(),this.delete(),this.filter()},update_bg:function(){o(document.body).on("click",".epl-all-tags-single-tag .epl-colors-list  li",function(e){e.preventDefault();var t=o(this),e=(o(this).siblings().removeClass("active"),o(this).addClass("active"),{action:"contact_tags_update",term_id:o(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),bg:o(this).data("color"),_epl_nonce:epl_admin_vars.ajax_nonce});o.ajax({type:"POST",data:e,url:ajaxurl,success:function(e){e&&(t.closest(".epl-lock").find(".epl-tag-btn").data("accent",t.data("color")),t.closest(".epl-lock").find(".epl-tag-btn").css("background",t.data("color")))}})})},update_name:function(){o(document.body).on("blur","#epl-single-tag-name-input",function(e){e.preventDefault();var t=o(this),e={action:"contact_tags_update",term_id:o(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),label:o(this).val(),_epl_nonce:epl_admin_vars.ajax_nonce};o.ajax({type:"POST",data:e,url:ajaxurl,success:function(e){e&&t.closest(".epl-lock").find(".epl-tag-btn").text(t.val())}})})},delete:function(){o(document.body).on("click",".epl-single-tag-opts .dashicons-trash",function(e){e.preventDefault();var t=o(this),e={action:"contact_tags_update",term_id:o(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),delete:1,_epl_nonce:epl_admin_vars.ajax_nonce};o.ajax({type:"POST",data:e,url:ajaxurl,success:function(e){e&&t.closest(".epl-lock").fadeOut().remove()}})})},filter:function(){o(document.body).on("click",".epl-single-tag-opts .dashicons-filter",function(e){e.preventDefault();e=o(this).closest(".epl-lock").find(".epl-tag-btn").data("id");window.location.href="admin.php?page=epl-contacts&tag_filter="+e})}}.init(),"1"==epl_admin_vars.display_hidden_fields&&o(".epl-field-type-hidden").each(function(){o(this).css("display","inline-block"),o(this).find("input,select").show()}),o("#property_address_coordinates").length&&""==epl_admin_vars.google_api_key&&"on"!=epl_admin_vars.google_map_disabled&&o("#epl_property_address_coordinates").after('<div class="epl-danger epl-warning-map-key"><p>'+epl_admin_vars.google_api_error+"</p></div>"),{init:function(){this.make_sortable(),this.add_image(),this.delete_image()},make_sortable:function(){o(".epl-listing-attachments-list").length&&o(".epl-listing-attachments-list").each(function(){var n=o(this);let l=n.data("extension");n.sortable({update:function(e,t){var a="";n.find("li").each(function(e){""===a?a=o(this).attr("data-id"):a+=","+o(this).attr("data-id")}),o.ajax({data:{order:a,id:o("#post_ID").val(),action:"epl_images_save_order",extension:l},type:"POST",url:ajaxurl})}}),n.disableSelection()})},add_image:function(){0<o(".epl-listing-images-upload-btn").length&&"undefined"!=typeof wp&&wp.media&&wp.media.editor&&o(document).on("click",".epl-listing-images-upload-btn",function(e){e.preventDefault();var l=o(this),i=wp.media({title:epl_admin_vars.add_images_button_text,frame:"post",multiple:!0,library:{type:"image",uploadedTo:wp.media.view.settings.post.id},button:{text:"Done"}});return i.on("close",function(){var t=l.closest(".epl-listing-attachments-list-wrap").find(".epl-listing-attachments-list"),a=t.data("extension"),n=t.data("prefix");i.state().get("selection").each(function(e){e=`
                                                                                
                                                                                <li data-id="`+(e=e.attributes).id+'"  class="ui-state-default epl-listing-attachments-list-item '+n+`admin_thumb">

                                                                                        <span class="epl-slider-unattach">
                                                                                                <div class="epl-radio-switch">
                                                                                                <input 
                                                                                                        id="epl-`+a+"-cmn-toggle-"+e.id+`" 
                                                                                                        class="epl-radio-switch-input epl-radio-switch-input--yes-no" 
                                                                                                        name="`+n+`enabled_thumbs[]" 
                                                                                                        checked="checked"
                                                                                                        value="`+e.id+`" 
                                                                                                        type="checkbox"
                                                                                                />
                                                                                                <label for="epl-`+a+"-cmn-toggle-"+e.id+`"></label>
                                                                                                </div>
                                                                                        </span>

                                                                                        <div class="epl-`+a+`-slide-tools epl-listing-attachment-tools">
                                                                                                <a target="_blank" href="post.php?post=`+e.id+`&action=edit">
                                                                                                <span class="epl-`+a+`-edit-attach dashicons dashicons-edit"></span>
                                                                                                </a>
                                                                                                <a href="#" class="epl-slider-`+a+`-delete-attach">
                                                                                                <span class="dashicons dashicons-trash"></span>
                                                                                                </a>
                                                                                        </div>
                                                                                        
                                                                                        <img src="`+e.sizes["admin-list-thumb"].url+`">
                                                                                </li>
                                                                        `;t.append(e)})}),i.open(l),!1})},delete_image:function(){o(document).on("click",".epl-listing-attachment-tools-delete-attach",function(e){e.preventDefault();var e=o(this).closest(".epl-listing-attachments-list-item"),t=e.data("id"),a=o(this).closest(".epl-listing-attachments-list"),n=a.data("extension"),a=a.data("prefix");o.ajax({data:{id:o("#post_ID").val(),action:"epl_images_unattach",img_id:t,prefix:a,extension:n},type:"POST",url:ajaxurl}),e.fadeOut().remove()})}}.init(),jQuery(document).on("click",".epl-update-inspection-times",function(e){e.preventDefault(),jQuery(".epl-inspection-markup").slideToggle()})});