function epl_generate_inspection_markup(){(new Date).getFullYear();return'<div class="epl-added-inspection"></div><div id="epl-inspection-markup" class="epl-inspection-markup"><input type="text" style="width:6em;" autocomplete="off" id="epl-inspection-date" maxlength="2" size="2" placeholder="01">  From <input class="validate[custom[onlyNumber]]" type="text" autocomplete="off" id="epl-inspection-start-hh" maxlength="2" size="2" placeholder="01">:<input type="text" autocomplete="off" id="epl-inspection-start-mm" maxlength="2" size="2" placeholder="01"> <select id="epl-inspection-start-ampm" class="epl-inspection-ampm"><option value="AM">AM</option><option value="PM">PM</option></select> | To <input class="validate[custom[onlyNumber]]" type="text" autocomplete="off" id="epl-inspection-end-hh" maxlength="2" size="2" placeholder="01">:<input class="validate[custom[onlyNumber]]" type="text" autocomplete="off" id="epl-inspection-end-mm" maxlength="2" size="2" placeholder="01"> <select id="epl-inspection-end-ampm" class="epl-inspection-ampm"><option value="AM">AM</option><option value="PM">PM</option></select><a id="epl-inspection-add" class="button">Add</a></div>'}jQuery(document).ready((function(e){var t,a,n={init:function(){this.display_address_note(),this.admin_listings_map(),n.manual_update(),this.mark_featured(),this.init_conditionals(),this.handle_conditional_fields(),this.init_settings_conditionals(),this.handle_settings_conditional_fields()},display_address_note:function(){jQuery(document).find("#property_address_display_yes").on("change",(function(){var e;jQuery(".epl-display-address-warning").remove(),jQuery(this).is(":checked")?jQuery(".epl-display-address-warning").remove():(e='<div class="notice notice-warning epl-display-address-warning" style="margin:10px 0;"><p>'+epl_admin_vars.display_address_note+"</p></div>",jQuery("#epl_property_address_coordinates").after(e))})),setTimeout((function(){jQuery(document).find("#property_address_display_yes").trigger("change")}),1e3)},admin_listings_map:function(){if(0===e("#epl_admin_map_canvas").length)return!1;var t=e("#epl_admin_map_canvas").data("address"),a="";if(!window.google)return!1;function n(t){var a=new google.maps.Map(document.getElementById("epl_admin_map_canvas"),{zoom:14,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP});t=new google.maps.Marker({position:t,draggable:!0});google.maps.event.addListener(t,"dragend",(function(t){e("#property_address_coordinates").val(t.latLng.lat()+", "+t.latLng.lng())})),google.maps.event.addListener(t,"dragstart",(function(e){})),a.setCenter(t.position),t.setMap(a)}function l(t){(new google.maps.Geocoder).geocode({address:t},(function(t){n(a=t[0].geometry.location),e("#property_address_coordinates").val(a.lat().toString()+", "+a.lng().toString())}))}""===t&&(t=epl_admin_vars.default_map_address);var o,i=e("#property_address_coordinates").val();!i||(i=i.split(", "),o=parseFloat(i[0]),i=parseFloat(i[1]),isNaN(o))||isNaN(i)?l(t):n(new google.maps.LatLng(o,i)),e(document.body).on("click",".epl-geocoder-button",(function(){var t=e(this),a=(listingUnit=t.closest("form").find("#property_address_sub_number").length?t.closest("form").find("#property_address_sub_number").val():t.closest("form").find("#property_address_lot_number").length?t.closest("form").find("#property_address_lot_number").val():"")+" ";e(["property_address_street_number","property_address_street","property_address_suburb","property_address_state","property_address_postal_code","property_address_country"]).each((function(e,n){0<t.closest("form").find("#"+n).length&&(a+=t.closest("form").find("#"+n).val()+" ")})),a=e.trim(a),e("#property_address_coordinates").val(""),a&&l(a)})),e("#property_address_coordinates").on("change",(function(){var t,a=e(this).val();a&&(a=a.split(", "),t=parseFloat(a[0]),a=parseFloat(a[1]),isNaN(t)||isNaN(a)||n(new google.maps.LatLng(t,a)))}))},manual_update:function(){jQuery("#epl_manual_update_lookup").on("click",(function(e){e.preventDefault();e=window.location.href.split("?")[0];var t=window.location.href.split("?")[1];e=null==t?e+"?epl_manual_update=1":e+"?"+t+"&epl_manual_update=1",window.location.replace(e)}))},mark_featured:function(){e(".column-property_featured span").on("click",(function(t){var a=e(this),n=e(this).closest("tr").attr("id");n=(n=n.split("-"))[1],e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"epl_update_featured_listing",id:n,_epl_nonce:epl_admin_vars.ajax_nonce},success:function(e){a.toggleClass("dashicons-star-empty dashicons-star-filled"),"no"==e.featured?a.closest("tr").find(".epl-listing-labels .featured").remove():a.closest("tr").find(".epl-listing-labels").append('<li class="featured">Featured</li>')}})}))},init_conditionals:function(){e(".epl-form-field-wrap input, .epl-form-field-wrap select, .epl-form-field-wrap textarea, .epl-form-field-wrap .epl-form-field-help").each((function(t){var a,n=e(this).closest(".epl-form-field-wrap"),l=!0,o=e(this).data("show");o&&(a=o.relation||"AND",o=o.fields||{},"AND"==a||"and"==a?e.each(o,(function(t,a){var n=a[0],o=a[1];a=a[2];e("#"+n).length&&("="===o?l&=a==e("#"+n).val():"!="===o?l&=a!=e("#"+n).val():">="===o?l&=parseFloat(e("#"+n).val())>=a:"<="===o?l&=parseFloat(e("#"+n).val())<=a:">"===o?l&=parseFloat(e("#"+n).val())>a:"<"===o&&(l&=parseFloat(e("#"+n).val())<a))})):(l=!1,e.each(o,(function(t,a){var n=a[0],o=a[1];a=a[2];e("#"+n).length&&("="===o?l=l||a==e("#"+n).val():"!="===o?l=l||a!=e("#"+n).val():">="===o?l=l||parseFloat(e("#"+n).val())>=a:"<="===o?l=l||parseFloat(e("#"+n).val())<=a:">"===o?l=l||parseFloat(e("#"+n).val())>a:"<"===o&&(l=l||parseFloat(e("#"+n).val())<a))}))),l?n.show():n.hide())}))},init_settings_conditionals:function(){e(".epl-field input, .epl-field select, .epl-field textarea, .epl-field .epl-form-field-help").each((function(t){var a,n=e(this).closest(".epl-field"),l=!0,o=e(this).data("show");o&&(a=o.relation||"AND",o=o.fields||{},"AND"==a||"and"==a?e.each(o,(function(t,a){var n=a[0],o=a[1];a=a[2];e("#"+n).length&&("="===o?l&=a==e("#"+n).val():"!="===o?l&=a!=e("#"+n).val():">="===o?l&=parseFloat(e("#"+n).val())>=a:"<="===o?l&=parseFloat(e("#"+n).val())<=a:">"===o?l&=parseFloat(e("#"+n).val())>a:"<"===o&&(l&=parseFloat(e("#"+n).val())<a))})):(l=!1,e.each(o,(function(t,a){var n=a[0],o=a[1];a=a[2];e("#"+n).length&&("="===o?l=l||a==e("#"+n).val():"!="===o?l=l||a!=e("#"+n).val():">="===o?l=l||parseFloat(e("#"+n).val())>=a:"<="===o?l=l||parseFloat(e("#"+n).val())<=a:">"===o?l=l||parseFloat(e("#"+n).val())>a:"<"===o&&(l=l||parseFloat(e("#"+n).val())<a))}))),l?n.show():n.hide())}))},handle_conditional_fields:function(){e(".epl-form-field-wrap input, .epl-form-field-wrap select, .epl-form-field-wrap textarea").on("change",(function(e){n.init_conditionals()}))},handle_settings_conditional_fields:function(){var t=e(".epl-field input, .epl-field select, .epl-field textarea");t.on("change",(function(e){n.init_settings_conditionals()})),t.each((function(){e(this).trigger("change")}))}};function l(e,t,a){a=a||window.location.href;var n,l=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi");return l.test(a)?null!=t?a.replace(l,"$1"+e+"="+t+"$2$3"):(a=(n=a.split("#"))[0].replace(l,"$1$3").replace(/(&|\?)$/,""),void 0!==n[1]&&null!==n[1]&&(a+="#"+n[1]),a):(null!=t&&(l=-1!==a.indexOf("?")?"&":"?",a=(n=a.split("#"))[0]+l+e+"="+t,void 0!==n[1])&&null!==n[1]&&(a+="#"+n[1]),a)}n.init(),0<e('input[name="epl_upload_button"]').length&&"undefined"!=typeof wp&&wp.media&&wp.media.editor&&e(document).on("click",'input[name="epl_upload_button"]',(function(t){t.preventDefault();var a=(t=e(this)).prev();return wp.media.editor.send.attachment=function(e,t){console.log(t),a.val(t.url)},wp.media.editor.open(t),!1})),e(".dependency-true").each((function(){var t,a=e(this),n=a.attr("data-parent");e('select[name="'+n+'"]').length&&"taxonomy"==a.attr("data-type")&&(t=a.attr("data-default"),e('select[name="'+n+'"]').change((function(){e.ajax({type:"POST",url:ajaxurl,data:{parent_id:e(this).val(),type_name:a.attr("data-type-name"),type:a.attr("data-type"),default_value:t,action:"epl_get_terms_drop_list",_epl_nonce:epl_admin_vars.ajax_nonce},success:function(e){a.html(e)}})})).trigger("change"))})),e(".epldatepicker").length&&e(".epldatepicker").each((function(t){var a=e(this).data("timepicker"),n=e(this).data("format");console.log(n),a=1==a,e(this).epl_datetimepicker({timepicker:a,format:n})})),e("#property_auction").length&&e("#property_auction").epl_datetimepicker({format:"Y-m-d H:i",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),e("#property_sold_date").length&&e("#property_sold_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),e("#property_list_date").length&&e("#property_list_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),e("#property_com_lease_end_date").length&&e("#property_com_lease_end_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),e("#property_date_available").length&&e("#property_date_available").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onSelectDate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)},onGenerate:function(e,t){var a=(a=t.val()).replace(" ","T");t.val(a)}}),e("#property_inspection_times").length&&(e("#property_inspection_times").hide(),t=(t=e("#property_inspection_times").val()).split("\n"),a='<tr class="form-field"><td>'+(a=epl_generate_inspection_markup())+"</td></tr>",e("#property_inspection_times").closest(".form-field").after(a),""!=e.trim(t)&&e.each(t,(function(t,a){e(".epl-added-inspection").append('<span><span class="epl-inspection-text">'+a+'</span><span class="del-inspection-time">X</span></span>')})),jQuery("#epl-inspection-date").epl_datetimepicker({timepicker:!1,format:"d-M-Y",closeOnDateSelect:!0,allowBlank:!1}),jQuery("#epl-inspection-start-hh").epl_datetimepicker({datepicker:!1,format:"h",hours12:!0}),jQuery("#epl-inspection-start-mm").epl_datetimepicker({datepicker:!1,format:"i",allowTimes:["00:00","00:05","00:10","00:15","00:20","00:25","00:30","00:35","00:40","00:45","00:50","00:55"]}),jQuery("#epl-inspection-end-hh").epl_datetimepicker({datepicker:!1,format:"h",hours12:!0}),jQuery("#epl-inspection-end-mm").epl_datetimepicker({datepicker:!1,format:"i",allowTimes:["00:00","00:05","00:10","00:15","00:20","00:25","00:30","00:35","00:40","00:45","00:50","00:55"]})),jQuery("form").length&&"function"==typeof jQuery.fn.validationEngine&&jQuery("form").validationEngine(),e(document).on("click",".del-inspection-time",(function(){var t=e(this).parent().find(".epl-inspection-text").text(),a=(a=e("#property_inspection_times").val()).split("\n");a=(a=jQuery.grep(a,(function(e){return e!=t}))).join("\n"),e("#property_inspection_times").val(a),e(this).parent().fadeOut(600,(function(){e(this).remove()}))})),e(document).on("click","#epl-inspection-add",(function(t){t.preventDefault();t=e("#epl-inspection-date").val()+" "+e("#epl-inspection-start-hh").val()+":"+e("#epl-inspection-start-mm").val()+e("#epl-inspection-start-ampm").val()+" to "+e("#epl-inspection-end-hh").val()+":"+e("#epl-inspection-end-mm").val()+e("#epl-inspection-end-ampm").val();var a=e("#property_inspection_times").val();a=a.split("\n"),-1==e.inArray(t,a)&&(a.push(t),t=e('<span><span class="epl-inspection-text">'+t+'</span><span class="del-inspection-time">X</span></span>'),a=a.join("\n"),e("#property_inspection_times").val(a),t.hide().appendTo(".epl-added-inspection").fadeIn(600))})),e(".epl-price-bar").hover((function(){e(this).addClass("shine")}),(function(){e(this).removeClass("shine")})),jQuery(".epl-fields-tab-menu ul li").click((function(){var e=jQuery(this).attr("data-tab"),t=l("sub_tab",e);history.pushState("","",t),jQuery(".epl-fields-tab-menu ul li").removeClass("epl-fields-menu-current"),jQuery(".epl-fields-single-menu").removeClass("epl-fields-field-current"),jQuery(".epl-field-intro").removeClass("active epl-show-help"),jQuery('[data-help="'+e+'"]').addClass("active epl-show-help"),jQuery(this).addClass("epl-fields-menu-current"),console.log("#tab-menu-"+e),jQuery("#"+e).addClass("epl-fields-field-current")})),e(".epl-upgrade-btn").length&&e(".epl-upgrade-btn").on("click",(function(t){t.preventDefault(),function t(){var a=e(".epl-upgrade-btn").data("upgrade");e(".epl-upgrade-btn"),a={action:"epl_upgrade_db",upgrade_to:a,_epl_nonce:epl_admin_vars.ajax_nonce};e(".epl-ajax-notice").show(),e.ajax({method:"POST",url:ajaxurl,data:a,dataType:"json"}).done((function(a){if("success"==a.status){if(e(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-success").html(a.msg),"processing"==a.buffer)try{t()}catch(a){e(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-fail").html("Please reload page & process again.")}}else e(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-fail").html(a.msg)}))}()}));var o,i,c,s={vars:{contact_card_wrap_editable:e(".epl-contact-card-wrapper .editable"),contact_card_wrap_edit_item:e(".epl-contact-card-wrapper .edit-item"),user_id:e('input[name="contactinfo[user_id]"]'),state_input:e(':input[name="contactinfo[state]"]'),note:e("#epl_contact_activity_content")},init:function(){this.edit_contact(),this.user_search(),this.remove_user(),this.cancel_edit(),this.change_country(),this.add_note(),this.add_note_note_tab(),this.add_listing(),this.delete_checked()},edit_contact:function(){e(document.body).on("click","#edit-contact",(function(e){e.preventDefault(),s.vars.contact_card_wrap_editable.hide(),s.vars.contact_card_wrap_edit_item.fadeIn().css("display","block")}))},user_search:function(){e(document.body).on("click.eplSelectUser",".epl_user_search_results a",(function(t){t.preventDefault(),t=e(this).data("userid"),s.vars.user_id.val(t)}))},remove_user:function(){e(document.body).on("click","#disconnect-contact",(function(t){t.preventDefault(),t={epl_action:"disconnect-userid",contact_id:e('input[name="contactinfo[id]"]').val(),_wpnonce:e("#edit-contact-info #_wpnonce").val()},e.post(ajaxurl,t,(function(e){window.location.href=window.location.href}),"json")}))},cancel_edit:function(){e(document.body).on("click","#epl-edit-contact-cancel",(function(t){t.preventDefault(),s.vars.contact_card_wrap_edit_item.hide(),s.vars.contact_card_wrap_editable.show(),e(".epl_user_search_results").html("")}))},change_country:function(){e('select[name="contactinfo[country]"]').change((function(){var t=e(this);return data={action:"epl_get_shop_states",country:t.val(),field_name:"contactinfo[state]",_epl_nonce:epl_admin_vars.ajax_nonce},e.post(ajaxurl,data,(function(e){"nostates"==e?s.vars.state_input.replaceWith('<input type="text" name="'+data.field_name+'" value="" class="epl-edit-toggles medium-text"/>'):s.vars.state_input.replaceWith(e)})),!1}))},add_note_note_tab:function(){e(document.body).on("click","#add-contact-note",(function(t){t.preventDefault();var a;t={epl_action:"add-contact-note-note-tab",contact_id:e("#epl-contact-id").val(),listing_id:e("#contact-note-listing").val(),activity_type:e("#contact-activity-type").val(),contact_note:e("#contact-note").val(),add_contact_note_nonce:e("#add_contact_note_nonce").val()};console.log(t),t.contact_note?e.ajax({type:"POST",data:t,url:ajaxurl,success:function(t){e("#epl-contact-notes").prepend(t),e(".epl-no-contact-notes").hide(),e("#contact-note").val("")}}).fail((function(e){window.console&&window.console.log&&console.log(e)})):(a=s.vars.note.css("border-color"),s.vars.note.css("border-color","red"),setTimeout((function(){s.vars.note.css("border-color",a)}),500))}))},add_note:function(){e(document.body).on("click","#epl_contact_activity_submit",(function(t){var a;t.preventDefault(),(t={epl_action:"add-contact-note",contact_id:e("#epl_contact_id").val(),listing_id:e("#epl_contact_activity_listing").val(),note_type:e("#epl_contact_activity_type").val(),contact_note:s.vars.note.val(),add_contact_note_nonce:e("#add_contact_note_nonce").val()}).contact_note?e.ajax({type:"POST",data:t,url:ajaxurl,success:function(t){s.vars.note.val(""),e(".epl-contact-activities tbody").prepend(t)}}).fail((function(e){window.console&&window.console.log&&console.log(e)})):(a=s.vars.note.css("border-color"),s.vars.note.css("border-color","red"),setTimeout((function(){s.vars.note.css("border-color",a)}),500))}))},add_listing:function(){e(document.body).on("click","#contact_listing_submit",(function(t){t.preventDefault();var a;t=data=e("#epl_contact_add_listing_form").serialize();(t+="&epl_action=add-contact-listing&contact_id="+e("#epl_contact_id").val()+"&_epl_nonce="+epl_admin_vars.ajax_nonce)?e.ajax({type:"POST",data:t,url:ajaxurl,success:function(t){s.vars.note.val(""),e(".epl-contact-listings tbody").prepend(t)}}).fail((function(e){window.console&&window.console.log&&console.log(e)})):(a=s.vars.note.css("border-color"),s.vars.note.css("border-color","red"),setTimeout((function(){s.vars.note.css("border-color",a)}),500))}))},delete_checked:function(){e("#epl-contact-delete-confirm").change((function(){var t=e("#epl-contact-delete-records"),a=e("#epl-delete-contact");e(this).prop("checked")?(t.attr("disabled",!1),a.attr("disabled",!1)):(t.attr("disabled",!0),t.prop("checked",!1),a.attr("disabled",!0))}))}};s.init(),e(".contact-action-category").on("click",(function(e){e.preventDefault(),e.stopPropagation(),jQuery(".epl-contact_category_suggestions").slideToggle(100)})),e(".contact-action-tag").on("click",(function(t){t.preventDefault(),t.stopPropagation(),jQuery(".epl-contact-tags-find").slideToggle(100),e("#contact-tag-hint").focus()})),e(document).on("click",(function(t){e(".epl-contact_category_suggestions").is(":visible")&&jQuery(".epl-contact_category_suggestions").slideUp(100),e(".epl-contact-tags-find").is(":visible")&&!e(".epl-contact-tags-find > input").is(":focus")&&jQuery(".epl-contact-tags-find").slideUp(100)})),e(".epl-contact_category_suggestions > li >  a").on("click",(function(t){t.preventDefault();var a=e(this).data("label");e.ajax({type:"POST",data:{action:"epl_contact_category_update",type:e(this).data("key"),contact_id:e("#epl_contact_id").val(),_epl_nonce:epl_admin_vars.ajax_nonce},dataType:"json",url:ajaxurl,success:function(t){t&&e(".epl-contact-entry-header span").text(a)}})})),e(".epl-contact_tags_suggestions > li").on("click",(function(t){t.preventDefault();var a={action:"contact_tags_update",contact_id:e("#epl_contact_id").val(),term_id:e(this).data("id"),bg:e(this).data("bg"),label:e(this).text(),_epl_nonce:epl_admin_vars.ajax_nonce};if(1<=e("#contact-tag-"+a.term_id).length)return!1;e.ajax({type:"POST",data:a,url:ajaxurl,success:function(t){e("#contact-tag-hint").val(""),e(".epl-contact_tags_suggestions > li").hide(),t&&(e("#contact-tag-hint").val(""),t='<li style="background:'+a.bg+'" data-id="'+a.term_id+'" id="contact-tag-'+a.term_id+'">'+a.label+'<span class="dashicons dashicons-no epl-contact-tag-del"></span></li>',e(".epl-contact-assigned-tags").append(t))}})})),e(".epl-contact-assigned-tags").on("click",".epl-contact-tag-del",(function(t){t.preventDefault();var a=e(this);t={action:"epl_contact_tag_remove",contact_id:e("#epl_contact_id").val(),term_id:e(this).parent().data("id"),label:e(this).parent().text(),_epl_nonce:epl_admin_vars.ajax_nonce};e.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){e&&a.parent().fadeIn(200).remove()}})})),e("#contact-tag-hint").keyup((function(t){var a=e(this).val();if(""==a)return!1;if(e(".epl-contact_tags_suggestions>li").each((function(){0==e(this).text().toLowerCase().indexOf(a)?e(this).show():e(this).hide()})),13==t.keyCode){var n={action:"contact_tags_update",contact_id:e("#epl_contact_id").val(),term_id:a,bg:"#39b54a",_epl_nonce:epl_admin_vars.ajax_nonce,label:a.charAt(0).toUpperCase()+a.slice(1)};if(1<=e("#contact-tag-"+epl.helpers.string_to_name(n.term_id).length))return!1;e.ajax({type:"POST",data:n,url:ajaxurl,success:function(t){e("#contact-tag-hint").val(""),e(".epl-contact_tags_suggestions > li").hide(),t&&(e("#contact-tag-hint").val(""),t='<li style="background:'+n.bg+'" data-id="'+t+'" id="contact-tag-'+t+'">'+n.term_id+'<span class="dashicons dashicons-no epl-contact-tag-del"></span></li>',e(".epl-contact-assigned-tags").append(t),jQuery(".epl-contact-tags-find").slideUp(100))}})}})),e(".epl-contact-add-activity").on("click",(function(){var t="Add New"==e(".epl-contact-add-activity").text()?"Close":"Add New";e(".epl-contact-add-activity").text(t),e("#epl-contact-add-activity-wrap").slideToggle(100)})),e(".epl-contact-add-listing").on("click",(function(){e("#epl-contact-add-listing-wrap").slideToggle(100)})),e(".epl-contact-addable:last").after('<span class="epl-contact-add-new-num">add another</span>'),e(".epl-contact-addable-email:last").after('<span class="epl-contact-add-new-email">add another</span>'),e(document).on("click",".epl-contact-add-new-num",(function(){var t='                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <div class="epl-contact-new-num">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <input type="number" maxlength="60" class="epl-contact-sub" name="'+epl.helpers.get_unique_name("phone","contact_phones")+'">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <select id="epl-contact-sub-select" type="select" class="epl-contact-note-select" >                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <option value="phone">Phone</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <option value="mobile">Mobile</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <option value="office">Office</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <option value="home">Home</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </select>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ';e(this).before(t)})),e(document).on("click",".epl-contact-add-new-email",(function(){
var t='                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <div class="epl-contact-new-email">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <input type="email" maxlength="60" class="epl-contact-sub" name="'+epl.helpers.get_unique_name("email","contact_emails")+'">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <select id="epl-contact-sub-mail" type="select" class="epl-contact-note-select" >                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <option value="email">Email</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <option value="work">Work</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <option value="office">Office</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <option value="home">Home</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </select>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ';e(this).before(t)})),1==jQuery(".epl-contact-view-more").length&&195<=jQuery(".epl-contact-main-wrapper.left")[0].scrollHeight&&jQuery(".epl-contact-view-more").css("display","block"),jQuery(".epl-contact-view-more").on("click",(function(){var e=jQuery(this).closest(".epl-contact-main-wrapper.left").height();e<=190?(jQuery(this).closest(".epl-contact-main-wrapper.left").height("auto"),jQuery(this).css("position","relative").html('<span class="dashicons dashicons-arrow-right-alt epl-contact-icons"></span>View Less')):(jQuery(this).closest(".epl-contact-main-wrapper.left").height("190px"),jQuery(this).css("position","absolute").html('<span class="dashicons dashicons-arrow-right-alt epl-contact-icons"></span>View More')),console.log(e)})),e(document).on("click","#epl-contact-sub-select",(function(){var t=epl.helpers.get_unique_name(e(this).val(),"contact_phones");e(this).prev().attr("name",t)})),e(document).on("click","#epl-contact-sub-mail",(function(){var t=epl.helpers.get_unique_name(e(this).val(),"contact_emails");e(this).prev().attr("name",t)})),e("#epl-item-tables-wrapper").on("click","th",(function(t){t.preventDefault(),t=e(this),e("#epl-contact-table-orderby").val(e(this).data("sort")),console.log(e("#epl-contact-table-orderby").val()),t.hasClass("epl-sorted-desc")?(t.addClass("epl-sorted-asc"),e("#epl-contact-table-order").val("ASC")):(e("#epl-contact-table-order").val("DESC"),t.addClass("epl-sorted-desc")),t={action:"epl_contact_get_activity_table",contact:e("#epl_contact_id").val(),number:10,paged:1,orderby:e("#epl-contact-table-orderby").val(),order:e("#epl-contact-table-order").val(),_epl_nonce:epl_admin_vars.ajax_nonce},e.ajax({type:"POST",data:t,url:ajaxurl,success:function(t){t&&e("#epl-contact-activity-table-wrapper").html(t)}})})),e(document).on("click",".epl-contact-load-activities",(function(t){var a=e(this).data("page");a={action:"epl_contact_get_activity_table",contact:e("#epl_contact_id").val(),number:10,paged:a,orderby:e("#epl-contact-table-orderby").val(),order:e("#epl-contact-table-order").val(),_epl_nonce:epl_admin_vars.ajax_nonce};e.ajax({type:"POST",data:a,url:ajaxurl,success:function(t){var a;0!=t&&(a=e(t).find("tbody").html(),t=e(t).find(".epl-contact-load-activities").data("page"),e("#epl-contact-activity-table-wrapper").find("tbody").append(a),e(".epl-contact-load-activities").data("page",t))}})})),{init:function(){this.date_options()},date_options:function(){e("#epl-graphs-date-options").change((function(){var t=e(this),a=e("#epl-date-range-options");"other"===t.val()?a.show():a.hide()}))}}.init(),1==e("#property_owner").length&&(o=null,e("#property_owner").keyup((function(){if(""==e("#property_owner").val())return e(".epl-contact-listing-suggestion").fadeOut(),!1;null!=o&&clearTimeout(o);var t=e(this).val();data={action:"epl_search_contact",user_name:t,_epl_nonce:epl_admin_vars.ajax_nonce},o=setTimeout((function(){o=null,e.ajax({type:"POST",data:data,url:ajaxurl,success:function(t){1==e(".epl-contact-listing-suggestion").length?e(".epl-contact-listing-suggestion").replaceWith(t):e("#property_owner").after(t),e(".epl-contact-listing-suggestion").fadeIn()}})}),300)})),e(document.body).on("click",".epl-contact-listing-suggestion li",(function(t){e("#property_owner").val(e(this).data("id")),e(".epl-contact-listing-suggestion").fadeOut()}))),1==e("#epl_contact_wp_user").length&&(i=null,e("#epl_contact_wp_user").keyup((function(t){var a=t.currentTarget;if(document.body.style.cursor="progress",""==e(a).val())return e(".epl-contact-user-suggestion").fadeOut(),!1;null!=i&&clearTimeout(i),t=e(this).val(),data={action:"epl_search_user",user_name:t,_epl_nonce:epl_admin_vars.ajax_nonce},i=setTimeout((function(){i=null,e.ajax({type:"POST",data:data,url:ajaxurl,success:function(t){document.body.style.cursor="auto",1==e(".epl-contact-user-suggestion").length?e(".epl-contact-user-suggestion").replaceWith(t):e(a).after(t),e(".epl-contact-user-suggestion").fadeIn()}})}),300)})),e(document.body).on("click",".epl-contact-user-suggestion li",(function(t){e("#epl_contact_wp_user").val(e(this).text()),e("#epl_contact_wp_user_id").val(e(this).data("id")),e(".epl-contact-user-suggestion").fadeOut()}))),0<e(".epl-widget-author-username").length&&(i=null,e(".epl-widget-author-username").keyup((function(t){var a=t.currentTarget;if(document.body.style.cursor="progress",""==e(a).val())return e(".epl-contact-user-suggestion").fadeOut(),!1;null!=i&&clearTimeout(i),t=(t=(t=e(this).val()).split(","))[t.length-1],data={action:"epl_search_user",user_name:t,exclude_roles:"subscriber",_epl_nonce:epl_admin_vars.ajax_nonce},i=setTimeout((function(){i=null,e.ajax({type:"POST",data:data,url:ajaxurl,success:function(t){document.body.style.cursor="auto",1==e(".epl-contact-user-suggestion").length?e(".epl-contact-user-suggestion").replaceWith(t):e(a).after(t),e(".epl-contact-user-suggestion").fadeIn()}})}),300)})),e(document.body).on("click",".epl-contact-user-suggestion li",(function(t){var a=e(this).closest(".epl-contact-user-suggestion").prev(),n=a.val();(curr_val_arr=n.split(",")).splice(-1,1),n=""==(n=curr_val_arr.join(","))?e(this).data("uname")+",":n+","+e(this).data("uname")+",",a.val(n),e(".epl-contact-user-suggestion").fadeOut().remove()}))),1!=e("#property_second_agent").length&&1!=e("#property_agent").length||(i=null,e("#property_fourth_agent,#property_third_agent,#property_second_agent,#property_agent").keyup((function(t){var a=t.currentTarget;if(document.body.style.cursor="progress",""==e(a).val())return e(".epl-contact-user-suggestion").fadeOut(),!1;null!=i&&clearTimeout(i),t=e(this).val(),data={action:"epl_search_user",user_name:t,_epl_nonce:epl_admin_vars.ajax_nonce},i=setTimeout((function(){i=null,e.ajax({type:"POST",data:data,url:ajaxurl,success:function(t){document.body.style.cursor="auto",1==e(".epl-contact-user-suggestion").length?e(".epl-contact-user-suggestion").replaceWith(t):e(a).after(t),e(".epl-contact-user-suggestion").fadeIn()}})}),300)})),e(document.body).on("click",".epl-contact-user-suggestion li",(function(t){e(this).closest(".epl-contact-user-suggestion").prev().val(e(this).data("uname")),e(".epl-contact-user-suggestion").fadeOut().remove()}))),1==e("#epl_contact_listing_search").length&&(c=null,e("#epl_contact_listing_search").keyup((function(){if(""==e("#epl_contact_listing_search").val())return e(".epl-contact-owned-listing-suggestion").fadeOut(),!1;null!=c&&clearTimeout(c);var t=e(this).val();data={action:"epl_search_contact_listing",s:t,contact:e("#epl_contact_id").val(),_epl_nonce:epl_admin_vars.ajax_nonce},c=setTimeout((function(){c=null,e.ajax({type:"POST",data:data,url:ajaxurl,success:function(t){1==e(".epl-contact-owned-listing-suggestion").length?e(".epl-contact-owned-listing-suggestion").replaceWith(t):e("#epl_contact_listing_search").after(t),e(".epl-contact-owned-listing-suggestion").fadeIn()}})}),300)})),e(document.body).on("click",".epl-contact-owned-listing-suggestion li",(function(t){var a=e(this).data("id");e.ajax({type:"POST",data:{epl_action:"add-existing-contact-listing",contact_id:e("#epl_contact_id").val(),id:a,_epl_nonce:epl_admin_vars.ajax_nonce},url:ajaxurl,success:function(t){e(".epl-contact-listings tbody").prepend(t),e(".epl-contact-owned-listing-suggestion").fadeOut(),e("#epl_contact_listing_search").val("")}})}))),e(document.body).on("click.eplSelectUser",".epl_user_search_results span a",(function(t){t.preventDefault(),t=e(this).data("login"),e(".epl-ajax-user-search").val(t),e(".epl_user_search_results").addClass("hidden"),e(".epl_user_search_results span").html("")})),e(document.body).on("click.eplCancelUserSearch",".epl_user_search_results a.epl-ajax-user-cancel",(function(t){t.preventDefault(),e(".epl-ajax-user-search").val(""),e(".epl_user_search_results").addClass("hidden"),e(".epl_user_search_results span").html("")})),e("#epl-contact-add-listing-wrap").on("blur","input",(function(t){var a="";a=(a=(a=(a=(a=(a=(a=(a+=""!=e("#property_address_lot_number").val()?e("#property_address_lot_number").val()+"/":"")+(""!=e("#property_address_sub_number").val()?e("#property_address_sub_number").val()+" ":""))+(""!=e("#property_address_street_number").val()?e("#property_address_street_number").val()+" ":""))+(""!=e("#property_address_street").val()?e("#property_address_street").val()+" ":""))+(""!=e("#property_address_suburb").val()?e("#property_address_suburb").val()+" ":""))+(""!=e("#property_address_state").val()?e("#property_address_state").val()+" ":""))+(""!=e("#property_address_postal_code").val()?e("#property_address_postal_code").val()+" ":""))+(""!=e("#property_address_country").val()?e("#property_address_country").val()+" ":"");e("#post_title").val(a)})),e(document).on("change",".epl_contact_type_filter",(function(t){var a=e(this).val();""!=a&&(document.location.href=l("cat_filter",a))})),e(".epl-contact-list-table-tags").on("click",".epl-contact-assigned-tags li",(function(t){var a=e(this).data("id");""!=a&&(document.location.href=l("tag_filter",a))})),e(".epl-contact-all-tags-container > span .epl-tag-btn").on("mouseleave",(function(t){if(e(this).parent().hasClass("epl-lock"))return!1;e(this).css({background:"#fff",color:e(this).data("accent")})})),e(".epl-contact-all-tags-container > span .epl-tag-btn").on("mouseenter",(function(t){if(e(this).parent().hasClass("epl-lock"))return!1;e(this).css({background:e(this).data("accent"),color:"#fff"})})),e(document.body).on("click",".epl-contact-all-tags-container > span .epl-tag-btn",(function(t){if(par=e(this).parent(),t.preventDefault(),e(this).parent().hasClass("epl-lock"))return!1;par.siblings().removeClass("epl-lock").find(".epl-popup-box").remove(),par.siblings().find(".epl-tag-btn").trigger("mouseleave"),par.toggleClass("epl-lock"),1!=e(this).find(".epl-popup-box").length&&e('<div class="epl-popup-box epl-all-tags-single-tag">\n    <span class="epl-single-tag-name">\n        <input type="text" id="epl-single-tag-name-input">\n    </span>\n    <ul class="epl-colors-list" >\n        <li class="epl-color-gray" data-color="#d2d2d2"><b></b></li>\n        <li class="epl-color-green" data-color="#43ac6d"><b></b></li>\n        <li class="epl-color-blue" data-color="#459bc4"><b></b></li>\n        <li class="epl-color-orange" data-color="#f9845b"><b></b></li>\n        <li class="epl-color-purple" data-color="#7d669e"><b></b></li>\n        <li class="epl-color-red" data-color="#ed5a5a"><b></b></li>\n        <li class="epl-color-yellow" data-color="#ecc33f"><b></b></li>\n    </ul>\n    <div class="epl-single-tag-opts">\n        <span data-action="filter" title="Filter" class="dashicons dashicons-filter"></span>\n        <span data-action="delete" title="Trash" class="dashicons dashicons-trash"></span>\n    </div>\n</div>').appendTo(par).slideDown()})),{init:function(){this.update_bg(),this.update_name(),this.delete(),this.filter()},update_bg:function(){e(document.body).on("click",".epl-all-tags-single-tag .epl-colors-list  li",(function(t){t.preventDefault();var a=e(this);e(this).siblings().removeClass("active"),e(this).addClass("active"),t={action:"contact_tags_update",term_id:e(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),bg:e(this).data("color"),_epl_nonce:epl_admin_vars.ajax_nonce};e.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){e&&(a.closest(".epl-lock").find(".epl-tag-btn").data("accent",a.data("color")),a.closest(".epl-lock").find(".epl-tag-btn").css("background",a.data("color")))}})}))},update_name:function(){e(document.body).on("blur","#epl-single-tag-name-input",(function(t){t.preventDefault();var a=e(this);t={action:"contact_tags_update",term_id:e(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),label:e(this).val(),_epl_nonce:epl_admin_vars.ajax_nonce};e.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){e&&a.closest(".epl-lock").find(".epl-tag-btn").text(a.val())}})}))},delete:function(){e(document.body).on("click",".epl-single-tag-opts .dashicons-trash",(function(t){t.preventDefault();var a=e(this);t={action:"contact_tags_update",term_id:e(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),delete:1,_epl_nonce:epl_admin_vars.ajax_nonce};e.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){e&&a.closest(".epl-lock").fadeOut().remove()}})}))},filter:function(){e(document.body).on("click",".epl-single-tag-opts .dashicons-filter",(function(t){t.preventDefault(),t=e(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),window.location.href="admin.php?page=epl-contacts&tag_filter="+t}))}}.init(),"1"==epl_admin_vars.display_hidden_fields&&e(".epl-field-type-hidden").each((function(){e(this).css("display","inline-block"),e(this).find("input,select").show()})),e("#property_address_coordinates").length&&""==epl_admin_vars.google_api_key&&"on"!=epl_admin_vars.google_map_disabled&&e("#epl_property_address_coordinates").after('<div class="epl-danger epl-warning-map-key"><p>'+epl_admin_vars.google_api_error+"</p></div>"),{init:function(){this.make_sortable(),this.add_image(),this.delete_image()},make_sortable:function(){e(".epl-listing-attachments-list").length&&e(".epl-listing-attachments-list").each((function(){var t=e(this);let a=t.data("extension");t.sortable({update:function(n,l){var o="";t.find("li").each((function(t){""===o?o=e(this).attr("data-id"):o+=","+e(this).attr("data-id")})),e.ajax({data:{order:o,id:e("#post_ID").val(),action:"epl_images_save_order",extension:a},type:"POST",url:ajaxurl})}}),t.disableSelection()}))},add_image:function(){0<e(".epl-listing-images-upload-btn").length&&"undefined"!=typeof wp&&wp.media&&wp.media.editor&&e(document).on("click",".epl-listing-images-upload-btn",(function(t){t.preventDefault();var a=e(this),n=wp.media({title:epl_admin_vars.add_images_button_text,frame:"post",multiple:!0,library:{type:"image",uploadedTo:wp.media.view.settings.post.id},button:{text:"Done"}});return n.on("close",(function(){var e=a.closest(".epl-listing-attachments-list-wrap").find(".epl-listing-attachments-list"),t=e.data("extension"),l=e.data("prefix");n.state().get("selection").each((function(a){a='\n                                                                                \n                                                                                <li data-id="'+(a=a.attributes).id+'"  class="ui-state-default epl-listing-attachments-list-item '+l+'admin_thumb">\n\n                                                                                        <span class="epl-slider-unattach">\n                                                                                                <div class="epl-radio-switch">\n                                                                                                <input \n                                                                                                        id="epl-'+t+"-cmn-toggle-"+a.id+'" \n                                                                                                        class="epl-radio-switch-input epl-radio-switch-input--yes-no" \n                                                                                                        name="'+l+'enabled_thumbs[]" \n                                                                                                        checked="checked"\n                                                                                                        value="'+a.id+'" \n                                                                                                        type="checkbox"\n                                                                                                />\n                                                                                                <label for="epl-'+t+"-cmn-toggle-"+a.id+'"></label>\n                                                                                                </div>\n                                                                                        </span>\n\n                                                                                        <div class="epl-'+t+'-slide-tools epl-listing-attachment-tools">\n                                                                                                <a target="_blank" href="post.php?post='+a.id+'&action=edit">\n                                                                                                <span class="epl-'+t+'-edit-attach dashicons dashicons-edit"></span>\n                                                                                                </a>\n                                                                                                <a href="#" class="epl-slider-'+t+'-delete-attach">\n                                                                                                <span class="dashicons dashicons-trash"></span>\n                                                                                                </a>\n                                                                                        </div>\n                                                                                        \n                                                                                        <img src="'+a.sizes["admin-list-thumb"].url+'">\n                                                                                </li>\n                                                                        ',e.append(a)}))})),n.open(a),!1}))},delete_image:function(){e(document).on("click",".epl-listing-attachment-tools-delete-attach",(function(t){t.preventDefault();var a=(t=e(this).closest(".epl-listing-attachments-list-item")).data("id"),n=(l=e(this).closest(".epl-listing-attachments-list")).data("extension"),l=l.data("prefix");e.ajax({data:{id:e("#post_ID").val(),action:"epl_images_unattach",img_id:a,prefix:l,extension:n},type:"POST",url:ajaxurl}),t.fadeOut().remove()}))}}.init()}));